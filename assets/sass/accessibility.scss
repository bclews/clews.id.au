/**
 * Accessibility Fixes for clews.id.au
 * Based on UX_ACCESSIBILITY_REVIEW.md recommendations
 */

/* ==========================================================================
   1. Skip Navigation Link (WCAG 2.4.1 Level A - CRITICAL)
   ========================================================================== */

.skip-link {
  position: fixed;
  top: 0;
  left: 0;
  background: #000;
  color: #fff;
  padding: 8px 16px;
  text-decoration: none;
  z-index: 10000;
  border-radius: 0 0 4px 0;
  font-weight: 600;
  /* Hide by default using transform - more reliable than top positioning */
  transform: translateY(-100%);
  transition: transform 0.2s ease-in-out;
  /* Override global touch target styles */
  display: block !important;
  min-height: auto !important;
  min-width: auto !important;

  &:focus {
    transform: translateY(0);
    outline: 3px solid #fff;
    outline-offset: 2px;
  }
}

/* ==========================================================================
   2. Theme Toggle Button Styling
   ========================================================================== */

/* Support both button and anchor for theme toggle */
button#mode,
a#mode {
  -webkit-transform: scale(1, 1);
  transform: scale(1, 1);
  opacity: 0.7;
  z-index: 1;
  background: none;
  border: none;
  padding: 0;
  cursor: pointer;

  &:hover {
    cursor: pointer;
    opacity: 1;
  }

  &:active {
    -webkit-transform: scale(0.9, 0.9);
    transform: scale(0.9, 0.9);
  }

  /* Light mode default - show moon icon (dark) */
  .mode-moon {
    display: block;
    line {
      stroke: #000;
      fill: none;
    }
    circle {
      fill: #000;
      stroke: #000;
    }
  }

  .mode-sunny {
    display: none;
    line {
      stroke: #fafafa;
      fill: none;
    }
    circle {
      fill: none;
      stroke: #fafafa;
    }
  }
}

/* Dark mode - show sun icon (light) */
.dark button#mode,
.dark a#mode {
  .mode-sunny {
    display: block;
  }
  .mode-moon {
    display: none;
  }
}

/* ==========================================================================
   3. Enhanced Focus Indicators (WCAG 2.4.7 Level AA)
   ========================================================================== */

/* Increase opacity from 0.6 to 1.0 for better visibility */
a:focus,
button:focus,
input:focus,
select:focus,
textarea:focus {
  outline: 3px solid rgba(0, 54, 199, 1) !important;  /* Changed from 0.6 to 1 */
  outline-offset: 2px;
}

/* Dark mode focus - also increase opacity */
.dark a:focus,
.dark button:focus,
.dark input:focus,
.dark select:focus,
.dark textarea:focus {
  outline-color: rgba(44, 118, 246, 1) !important;  /* Changed from 0.6 to 1 */
}

/* ==========================================================================
   3. Touch Target Sizes (WCAG 2.5.5 Level AAA)
   ========================================================================== */

/* Ensure all interactive elements meet 44x44px minimum */
a, button {
  min-height: 44px;
  min-width: 44px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

/* Social icons need larger hit areas */
.footer_social-icons a {
  padding: 12px;
  min-width: 44px;
  min-height: 44px;
}

/* Home logo icon */
.logo {
  padding: 12px;
  min-width: 44px;
  min-height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Theme toggle button */
#mode {
  padding: 12px;
  min-width: 44px;
  min-height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Menu trigger (hamburger icon) */
.menu-icon {
  padding: 12px;
  min-width: 44px;
  min-height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Article links need padding but not block display */
article a {
  position: relative;
  min-height: auto;
  min-width: auto;
  display: inline;
  padding: 8px 0;
}

/* Go to top button */
#totop {
  min-width: 48px;
  min-height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ==========================================================================
   4. Homepage and Post Page Layout Fixes
   ========================================================================== */

/* Reduce top margin from author section on homepage
   The original theme had .author as first child of .wrapper with 6.3rem top margin.
   We've restructured for accessibility with .author inside main. Balance spacing. */
main .author {
  margin-top: 3.5rem;  /* Reduced from 6.3rem for better visual balance */
}

/* Reduce excessive top margin on article headers (post pages)
   The theme has .header with margin-top: 7.8em which creates huge spacing.
   This is excessive when inside our main element structure. */
article .header {
  margin-top: 2rem;  /* Significantly reduced from 7.8em for tighter spacing */
}

/* Also reduce on list pages */
.list-page .header {
  margin-top: 2rem;  /* Reduced from 7.8em */
}

/* ==========================================================================
   5. Paragraph Spacing Enhancement
   ========================================================================== */

/* Increase from 30px (15+15) to 40px (20+20) for better readability */
.page-content > p {
  padding-top: 20px !important;     /* Increase from 15px */
  padding-bottom: 20px !important;  /* Increase from 15px */
}

/* ==========================================================================
   6. Link Visibility in Content
   ========================================================================== */

/* Add underlines to links in article content for better visibility */
article a,
.page-content a {
  text-decoration: underline;
  text-decoration-thickness: 1px;
  text-underline-offset: 2px;
}

article a:hover,
.page-content a:hover {
  text-decoration-thickness: 2px;
}

/* ==========================================================================
   6. Reading Time Styling
   ========================================================================== */

.reading-time {
  margin-left: 12px;
  color: var(--text-secondary);
  font-size: 0.875em;
}

.reading-time::before {
  content: "â€¢ ";
  margin-right: 4px;
}

/* ==========================================================================
   7. Current Page Indicator in Navigation
   ========================================================================== */

.menu-link.active {
  font-weight: 600;
  position: relative;
}

.menu-link.active::after {
  content: '';
  position: absolute;
  bottom: -2px;
  left: 0;
  right: 0;
  height: 2px;
  background: currentColor;
}

/* ==========================================================================
   8. Mobile Menu Improvements
   ========================================================================== */

/* Lock scroll when menu is open */
body.menu-open {
  overflow: hidden;
}

/* Dim and blur background more aggressively */
.wrapper.blurry {
  filter: blur(8px) brightness(0.3);
  pointer-events: none;
}

/* Make menu trigger semi-transparent in dark mode to show blurred background */
html.dark .navbar input[type="checkbox"]:checked ~ .trigger,
html:not(.light) .navbar input[type="checkbox"]:checked ~ .trigger {
  background-color: rgba(26, 26, 30, 0.95) !important;
}

/* Ensure menu is above blurred content */
.menu {
  z-index: 1000;
}

/* ==========================================================================
   9. Screen Reader Only Text Utility
   ========================================================================== */

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* ==========================================================================
   10. Responsive Adjustments
   ========================================================================== */

/* Reduce touch target requirements on desktop */
@media (min-width: 769px) {
  a, button {
    min-height: auto;
    min-width: auto;
  }

  /* Keep important interactive elements sized appropriately */
  .footer_social-icons a,
  .logo,
  #mode,
  .menu-icon,
  #totop {
    min-width: 44px;
    min-height: 44px;
  }
}

/* Mobile-specific improvements */
@media (max-width: 768px) {
  /* Ensure back-to-top is always visible on mobile for long articles */
  #totop {
    opacity: 1 !important;
    visibility: visible !important;
  }

  /* Reduce excessive top margins on mobile */
  main .author {
    margin-top: 1.5rem;  /* Reduced from 3.5rem for mobile */
  }

  article .header,
  .list-page .header {
    margin-top: 1rem;  /* Reduced from 2rem for mobile */
  }

  /* Fix navbar height on mobile - make it compact */
  .navbar {
    height: 50px !important;  /* Match the menu height */
    padding: 0 !important;  /* Remove padding to save space */
    display: flex;
    align-items: center;
  }

  /* Reduce navbar element sizing to fit compact navbar */
  .navbar .logo {
    position: absolute !important;
    left: 0.5rem !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    margin: 0 !important;
    padding: 4px !important;
    min-height: 36px !important;
    min-width: 36px !important;
  }

  /* Position #mode button only when menu is closed */
  .navbar input[type="checkbox"]:not(:checked) ~ .trigger #mode {
    position: absolute !important;
    left: auto !important;
    right: 44px !important;  /* Position to the left of menu icon */
    top: 50% !important;
    transform: translateY(-50%) !important;
    padding: 4px !important;
    min-height: 36px !important;
    min-width: 36px !important;
  }

  .navbar .menu-icon {
    position: absolute !important;
    right: 0.5rem !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    margin: 0 !important;
    padding: 4px !important;
    min-height: 36px !important;
    min-width: 36px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }
}
